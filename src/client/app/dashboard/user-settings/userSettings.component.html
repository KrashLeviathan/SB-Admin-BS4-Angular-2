<div class="container-fluid">
  <!-- Page Heading -->
  <div class="row">
    <div class="col-lg-12">
      <h2 class="page-header">
        User Settings
      </h2>
    </div>
  </div>
  <!-- /.row -->

  <div *ngIf="activeUser" class="row">
    <div class="col-md-9 col-lg-7 col-xl-6">

      <form #f="ngForm" (ngSubmit)="onSubmit(f)" role="form" novalidate class="buffer-bottom">
        <fieldset class="form-group"
                  [class.has-warning]="displayName.errors && (displayName.dirty || displayName.touched)"
                  [attr.disabled]="formDisabled ? true : null">
          <label class="form-control-label">Display Name</label>
          <input name="displayName" [ngModel]="activeUser.displayName"
                 required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH" #displayName="ngModel"
                 class="form-control form-control-warning" type="text" value="{{displayName.value}}">
        </fieldset>

        <div class="row">
          <div class="col-xs-4">
            <fieldset class="form-group"
                      [attr.disabled]="formDisabled ? true : null">
              <label class="form-control-label">Primary</label>
              <input name="primary" (focus)="setSelectedColor('primary')"
                     [ngModel]="activeUser.preferences.colorScheme.primary" #primary="ngModel"
                     required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH"
                     [style.background]="activeUser.preferences.colorScheme['primary']"
                     style="width: 100%; height: 11em;"
                     class="form-control form-control-warning" type="text"
                     [value]="activeUser.preferences.colorScheme['primary']"/>
            </fieldset>
          </div>
          <div class="col-xs-4">
            <fieldset class="form-group"
                      [attr.disabled]="formDisabled ? true : null">
              <label class="form-control-label">Secondary</label>
              <input name="secondary" (focus)="setSelectedColor('secondary')"
                     [ngModel]="activeUser.preferences.colorScheme.secondary" #secondary="ngModel"
                     required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH"
                     [style.background]="activeUser.preferences.colorScheme['secondary']"
                     style="width: 100%; height: 4em;"
                     class="form-control form-control-warning" type="text"
                     [value]="activeUser.preferences.colorScheme['secondary']"/>
            </fieldset>
            <fieldset class="form-group"
                      [attr.disabled]="formDisabled ? true : null">
              <label class="form-control-label">Accent</label>
              <input name="accent" (focus)="setSelectedColor('accent')"
                     [ngModel]="activeUser.preferences.colorScheme.accent" #accent="ngModel"
                     required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH"
                     [style.background]="activeUser.preferences.colorScheme['accent']" style="width: 100%; height: 4em;"
                     class="form-control form-control-warning" type="text"
                     [value]="activeUser.preferences.colorScheme['accent']"/>
            </fieldset>
          </div>
          <div class="col-xs-4">
            <fieldset class="form-group"
                      [attr.disabled]="formDisabled ? true : null">
              <label class="form-control-label">Light</label>
              <input name="neutralLight" (focus)="setSelectedColor('neutralLight')"
                     [ngModel]="activeUser.preferences.colorScheme.neutralLight" #neutralLight="ngModel"
                     required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH"
                     [style.background]="activeUser.preferences.colorScheme['neutralLight']"
                     style="width: 100%; height: 4em;"
                     class="form-control form-control-warning" type="text"
                     [value]="activeUser.preferences.colorScheme['neutralLight']"/>
            </fieldset>
            <fieldset class="form-group"
                      [attr.disabled]="formDisabled ? true : null">
              <label class="form-control-label">Dark</label>
              <input name="neutralDark" (focus)="setSelectedColor('neutralDark')"
                     [ngModel]="activeUser.preferences.colorScheme.neutralDark" #neutralDark="ngModel"
                     required minlength=4 [attr.maxlength]="MAX_VARCHAR_LENGTH"
                     [style.background]="activeUser.preferences.colorScheme['neutralDark']"
                     style="width: 100%; height: 4em;"
                     class="form-control form-control-warning" type="text"
                     [value]="activeUser.preferences.colorScheme['neutralDark']"/>
            </fieldset>
          </div>
        </div>

        <button type="button" class="btn btn-secondary" *ngIf="!formDisabled"
                (click)="cancelChanges(f)">Cancel
        </button>
        <button type="submit" class="btn btn-secondary" *ngIf="!formDisabled"
                (click)="onSubmit(f)">Submit
        </button>
        <button type="button" class="btn btn-secondary" *ngIf="formDisabled"
                (click)="formDisabled = !formDisabled"
                [attr.disabled]="savingState ? true : null">Make Changes
        </button>
        &nbsp;&nbsp;&nbsp;<i class="fa fa-lg fa-cog fa-spin" *ngIf="savingState"></i>
        &nbsp;&nbsp;&nbsp;<span class="text-danger" [hidden]="!errorOnSave">Invalid form!</span>
      </form>

    </div>
    <div class="col-md-9 col-lg-5 col-xl-6">
      <span [(colorPicker)]="activeUser.preferences.colorScheme[selectedColor]"
            [cpDialogDisplay]="'inline'" [cpCancelButton]="true" [cpCancelButtonClass]="'btn btn-primary'"
            [cpAlphaChannel]="'disabled'" [cpToggle]="!formDisabled"
            style="width: 0; height: 330px; display: inline-block"></span>

      <div [hidden]="!displayName.errors?.minlength" class="alert alert-warning" role="alert">
        Display Name must be greater than 4 characters.
      </div>
      <div [hidden]="!displayName.errors?.required" class="alert alert-warning" role="alert">
        Display Name is required.
      </div>
    </div>
  </div>
  <!-- /.row -->

</div>
